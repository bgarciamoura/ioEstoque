<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>IOSystem - Estoque - Página Inicial</title>

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.min.css">

        <!-- IMPORTAR JQUERY PARA USO NO SISTEMA -->
        <script>window.$ = window.jQuery = require('jquery');</script>

        <!-- SCRIPTS  -->
        <script src="../../node_modules/jquery-mask-plugin/dist/jquery.mask.min.js"></script>

        <!-- MEU CSS -->
        <link rel="stylesheet" href="index.css">
        <style>
            
        </style>
    </head>
    <body>
        <!-- BARRA SUPERIOR DO SISTEMA -->
        <nav class="navbar navbar-dark bg-dark header navbar-expand-lg">
            <a href="#" class="navbar-brand ml-0">
                <img src="../../_assets/_icons/garagem-aberta_48.png" alt="" class="d-inline-block align-top">
            </a>
            <span class="h3 p-4 text-white-50">IOSystem - Estoque</span>
        </nav>
        <!-- /BARRA SUPERIOR DO SISTEMA -->

        <!-- CONTEUDO PRINCIPAL DA PAGINA -->
        <div class="wrapper">
            
            <!-- SIDEBAR -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <h3>Menu</h3>
                </div>
                <div class="list-group p-2" role="tablist">
                    <a href="#produtos" class="list-group-item list-group-item-action active" id="item-produtos" data-toggle="list" role="tab" aria-controls="produtos">Produtos</a>
                    <a href="#movimentos" class="list-group-item list-group-item-action" id="item-movimentos" data-toggle="list" role="tab" aria-controls="movimentos">Movimentações</a>
                </div>
            </nav>
            <!-- /SIDEBAR -->
            
            <!-- CONTEUDO -->
            <div id="main-content" class="container-fluid">
                <nav class="navbar navbar-expand-lg navbar-light p-0 mt-2">
                    <div class="container-fluid">
                        <button type="button" id="sidebarCollapse" class="btn btn-info">Menu</button>
                    </div>
                </nav>
                <div class="tab-content" id="content">
                    <div class="tab-pane fade show active" id="produtos" aria-label="item-produtos">
                        
                        <div class="container-fluid align-content-center">
                            
                            <div class="row">
                                <div class="col-sm-12">
                                    
                                    <p class="h3 text-center">
                                        Produtos
                                    </p>
                                    
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="table-responsive-sm ">
                                        <table class="table table-hover border " id="tblProdutos">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Nome</th>
                                                    <th scope="col">Quantidade</th>
                                                    <th scope="col">Valor</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <th scope="row">1</th>
                                                    <td>Caneta</td>
                                                    <td>20</td>
                                                    <td>R$ 1,50</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">2</th>
                                                    <td>Lápis</td>
                                                    <td>25</td>
                                                    <td>R$ 0,80</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">3</th>
                                                    <td>Borracha</td>
                                                    <td>55</td>
                                                    <td>R$ 0,50</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">4</th>
                                                    <td>Apontador</td>
                                                    <td>150</td>
                                                    <td>R$ 1,75</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">5</th>
                                                    <td>Caderno</td>
                                                    <td>100</td>
                                                    <td>R$ 10,50</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">6</th>
                                                    <td>Sulfite</td>
                                                    <td>55</td>
                                                    <td>R$ 15,00</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">7</th>
                                                    <td>Guache</td>
                                                    <td>10</td>
                                                    <td>R$ 7,75</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-sm-4 mt-sm-2">
                                    <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#mdlCadastro">
                                        Cadastrar
                                    </button>
                                </div>
                                <div class="col-sm-4 mt-sm-2">
                                    <button class="btn btn-info btn-block" id="btnAlterar" data-toggle="modal" data-target="#mdlAlterar">
                                        Alterar
                                    </button>
                                </div>
                                <div class="col-sm-4 mt-sm-2">
                                    <button class="btn btn-danger btn-block" id="btnRemover">
                                        Remover
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        
                        

                    </div>
                    <div class="tab-pane fade" id="movimentos" aria-label="item-movimentos">
                        <p>
                            DOIS
                        </p>
                    </div>
                </div>
                
            </div>
            <!-- /CONTEUDO -->
        </div>
        <!-- /CONTEUDO PRINCIPAL DA PAGINA -->


        
        <!-- Modal -->
        <div class="modal fade" id="mdlCadastro" tabindex="-1" role="dialog" aria-labelledby="modalCadastro" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Cadastro de Produto</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-sm-12">
                                    <form action="post" id="frmCadastrar">
                                        <div class="form-group">
                                            <label for="txtNomeProduto">Produto</label>
                                            <input type="text" class="form-control" id="txtNomeProduto" placeholder="Informe o nome do produto..." name="nomeProduto">
                                        </div>
                                        <div class="form-group">
                                            <label for="qtdProduto">Quantidade</label>
                                            <input type="number" class="form-control" id="qtdProduto" placeholder="Informe a quantidade do produto..." min="1" name="quantidadeProduto">
                                        </div>
                                        <div class="form-group">
                                            <label for="txtValorProduto">Preço</label>
                                            <input type="text" class="form-control dinheiro" id="txtValorProduto" placeholder="Informe o preço do produto..." name="valorProduto">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                        <button type="submit" class="btn btn-primary" id="btnSalvar">Salvar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Alteração -->
        <div class="modal fade" id="mdlAlterar" tabindex="-1" role="dialog" aria-labelledby="modalAlteração" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Alteração de Produto</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-sm-12">
                                    <form action="post" >
                                        <div class="form-group">
                                            <label for="txtNomeProduto">Produto</label>
                                            <input type="text" class="form-control" id="txtNomeProdutoAlt" placeholder="Informe o nome do produto..." name="nomeProduto">
                                        </div>
                                        <div class="form-group">
                                            <label for="qtdProduto">Quantidade</label>
                                            <input type="number" class="form-control" id="qtdProdutoAlt" placeholder="Informe a quantidade do produto..." min="1" name="quantidadeProduto">
                                        </div>
                                        <div class="form-group">
                                            <label for="txtValorProduto">Preço</label>
                                            <input type="text" class="form-control dinheiro" id="txtValorProdutoAlt" placeholder="Informe o preço do produto..." name="valorProduto">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                        <button type="submit" class="btn btn-primary" id="btnSalvarAlt">Salvar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
        <script src="../../node_modules/popper.js/dist/popper.min.js"></script>
        <script src="../../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

        <!--MEUS SCRIPTS-->
        <script>

            var linhaSelecionada
            $(document).ready(function(){
                $('#sidebarCollapse').on('click', function () {
                    $('#sidebar').toggleClass('active');
                });
                // MASCARA DE DINHEIRO DA LIB JQUERY-MASK-PLUGIN
                $('.dinheiro').mask('#.##0,00', {reverse: true})

                // SALVAR PRODUTO NOVO DO MODAL
                $('#btnSalvar').click(function save() {
                    var newRow = $('<tr>')
                    var cols = ""
                    // PEGA A ULTIMA LINHA E ADICIONA EM UMA VARIAVEL
                    // EM SEGUIDA, ATRIBUI O VALOR DO ID DA LINHA A UMA VARIAVEL
                    var linha = $("#tblProdutos tr:last")
                    var id = parseInt($(linha[0]).text())
                    // VERIFICA SE O ID NÃO É NULO OU NaN
                    if (id == null || isNaN(id)) {
                        id = 1
                    } else {
                        id++
                    }

                    // CRIA UMA NOVA LINHA COM OS DADOS INCLUSOS PELO MODAL
                    cols += '<th scope="row">' + id.toString() + '</th>'
                    cols += '<td>' + $('#txtNomeProduto').val() + '</td>'
                    cols += '<td>' + $('#qtdProduto').val() + '</td>'
                    cols += '<td class="dinheiro">' + 'R$ ' + $('#txtValorProduto').val() + '</td>'
                    cols += '</tr>'
                    newRow.append(cols)
                    $('#tblProdutos').append(newRow)
                    
                    $('.modal').modal('hide')
                })

                $('.modal').on('hidden.bs.modal', function(){
                    $('#txtNomeProduto').val('')
                    $('#qtdProduto').val('')
                    $('#txtValorProduto').val('')
                })

                // SELECIONAR LINHA NA TABELA
                $(document).on('click', 'tr', function(){
                    $('tr').removeClass('selecionado')
                    $(this).addClass('selecionado')
                    linhaSelecionada = $(this).closest('tr')
                    
                })
                
                $('#btnRemover').click(function(){
                    
                    linhaSelecionada.fadeOut(400, function(){
                        linhaSelecionada.remove()
                    })
                })

                $('#btnAlterar').click(() => {
                    var colunas = linhaSelecionada.children()
                    var valor = $(colunas[3]).text()
                    var string = valor.replace('R$', '')
                    $('#txtNomeProdutoAlt').val($(colunas[1]).text())
                    $('#qtdProdutoAlt').val($(colunas[2]).text())
                    $('#txtValorProdutoAlt').val(string)
                    $('#btnSalvarAlt').click(()=> {
                        $(colunas[1]).text($('#txtNomeProdutoAlt').val())
                        $(colunas[2]).text($('#qtdProdutoAlt').val())
                        $(colunas[3]).text('R$ ' + $('#txtValorProdutoAlt').val())
                        $('.modal').modal('hide')
                    })
                })

            })
            
            
        </script>
    </body>
</html>